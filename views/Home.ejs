<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/Home.css"/>
    <script src="https://kit.fontawesome.com/4c7708918a.js" crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<body>
    <nav class="fnav">
        <div class="left">
            <img src="load.png" alt="">
            <input type="text" placeholder="Search For Movies"/>
        </div>
        <div class="right">
            <p>Location</p>
            <button id="logoutbutton">Sign Out</button>
            <i class="fa-solid fa-bars"></i>
        </div>
    </nav>
    <nav class="sec-nav">
        <div class="s-left">
            <p>Movies</p>
            <p>Bookings</p>
            <p>Group</p>
            
        </div>
        <div class="s-right">
            <p>ListYourShow</p>
            <p>Corporates</p>
            <p>Offer</p>
            
            
        </div>
    </nav>

    <div class="main">
        <img src="https://assets-in.bmscdn.com/promotions/cms/creatives/1664352328095_appkudaweb.jpg" alt="">
    </div>

    <div class="container">
        <h2>Recommended Movies</h2>
        
            <div class="card-scroll">
                <% movies.forEach(function(movie){%>
                <%if(movie.moviename){%>
                <div class="all-image" data-id="<%=movie._id%>">
                    
                    <img src="<%=movie.movieimage%>" alt="">
                <h3><%= movie.moviename %></h3>
                    <p>Genre: <%= movie.genre %></p>
                </div>
                
                <%}else{%>
                    <img src="/default-placeholder.png" alt="No Image Available">
                  <%}%>

                  <%})%>
            </div> 
        
          
    </div>

    <div class="banner">
        <img src="https://assets-in.bmscdn.com/discovery-catalog/collections/tr:w-1440,h-120:q-80/stream-leadin-web-collection-202210241242.png" alt="">
    </div>

    <div class="container">
        <h2>Gujarati Movies</h2>
        <div class="card">
            <img src="https://i.ytimg.com/vi/HEaXBHPCCFA/maxresdefault.jpg" alt="">
            <img src="https://m.media-amazon.com/images/M/MV5BNzMzNDE2Y2YtZDc5Ni00ZWE3LWE5MDctN2JhYjliMGVkZTA0XkEyXkFqcGc@._V1_.jpg" alt="">
            <img src="https://m.media-amazon.com/images/M/MV5BNTgwODJiODctY2Q4OC00NmJiLThhNGUtNzYxMjMyZTQxMWI3XkEyXkFqcGc@._V1_.jpg" alt="">
            <img src="https://i.ytimg.com/vi/sZ3iSjqAk-Q/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLC2PRV6VGXluq6ze7URGUTATWpI4g" alt="" class="">
            <img src="https://i.ytimg.com/vi/k_JTimmcO_g/maxresdefault.jpg" alt="" >
        </div>    
    </div>

    <div class="premiere">
        <h2>PREMIERE</h2>
        <div class="containers">
            <h2>Gujarati Movies</h2>
            <div class="card">
                <img src="https://upload.wikimedia.org/wikipedia/en/4/4a/Oppenheimer_%28film%29.jpg" alt="">
                <img src="https://m.media-amazon.com/images/M/MV5BNzMzNDE2Y2YtZDc5Ni00ZWE3LWE5MDctN2JhYjliMGVkZTA0XkEyXkFqcGc@._V1_.jpg" alt="">
                <img src="https://m.media-amazon.com/images/M/MV5BYmQwNzRiNmItODc4Ny00Mjk4LThmYWQtNjI5OGU4OGUxMmY0XkEyXkFqcGc@._V1_FMjpg_UX1000_.jpg" alt="">
                <img src="https://www.adgully.com/img/800/201808/if-i-stay-creative.jpg" alt="" class="">
                <img src="https://i.etsystatic.com/18242346/r/il/eab9fb/3072955208/il_570xN.3072955208_6uh1.jpg" alt="" >
            </div>    
        </div>
    </div>

    <div class="footer">
        <img src="logo.png" alt="">
        <div class="icon">
            <i class="fa-brands fa-facebook"></i>
            <i class="fa-brands fa-square-instagram"></i>
            <i class="fa-brands fa-twitter"></i>
            <i class="fa-brands fa-youtube"></i>
        </div>
    </div>
    <script>
        document.getElementById('logoutbutton').addEventListener('click',async(req,res)=>{
            try{
              const response = await fetch('/logout',{
                method:'GET',
                credentials:'include'
              })
              if(response.redirected){
                window.location.href = response.url
              }else{
                console.error('Logout failed:',response.statusText);
              }
            }catch(error){
              console.error('An error occured during logout',error);
            }
        });

        document.addEventListener('DOMContentLoaded',()=>{
            const movieCards = document.querySelectorAll(".all-image");
            if (movieCards.length === 0) {
                console.warn("No movie cards found.");
                return;
            }
            movieCards.forEach(card=>{
                card.addEventListener('click',()=>{
                    const movieId = card.getAttribute("data-id");
                    console.log("This is the movie id",movieId);
                    window.location.href = `/user/movie/${movieId}`;
                    console.log("Its been clicked");
                })
            })
        })
    </script>
</body>
</html>